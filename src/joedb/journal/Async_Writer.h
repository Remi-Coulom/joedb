#ifndef joedb_Async_Writer_declared
#define joedb_Async_Writer_declared

#include "joedb/journal/Buffered_File.h"

namespace joedb
{
 /// \ingroup journal
 class Async_Writer
 {
  private:
   Buffered_File &file;
   int64_t current;

  public:
   //////////////////////////////////////////////////////////////////////////
   Async_Writer(Buffered_File &file, int64_t start):
   //////////////////////////////////////////////////////////////////////////
    file(file),
    current(start)
   {
    file.flush();
   }

   //////////////////////////////////////////////////////////////////////////
   void write(const char *buffer, size_t size)
   //////////////////////////////////////////////////////////////////////////
   {
    file.pwrite(buffer, size, current);
    current += size;
   }

   //////////////////////////////////////////////////////////////////////////
   int64_t get_position() const
   //////////////////////////////////////////////////////////////////////////
   {
    return current;
   }
 };
}

#endif
