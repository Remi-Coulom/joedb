#include "Stream_File.h"

/////////////////////////////////////////////////////////////////////////////
joedb::Stream_File::Stream_File(std::iostream &stream, mode_t mode):
/////////////////////////////////////////////////////////////////////////////
 stream(stream)
{
 reset();

 Generic_File::mode = mode;

 if (stream.good())
  Generic_File::status = status_t::success;
 else
  Generic_File::status = status_t::failure;
}

/////////////////////////////////////////////////////////////////////////////
size_t joedb::Stream_File::read_buffer()
/////////////////////////////////////////////////////////////////////////////
{
 return size_t(stream.readsome(buffer, int64_t(buffer_size)));
}

/////////////////////////////////////////////////////////////////////////////
void joedb::Stream_File::write_buffer()
/////////////////////////////////////////////////////////////////////////////
{
 stream.write(buffer, int64_t(write_buffer_index));
}

/////////////////////////////////////////////////////////////////////////////
int joedb::Stream_File::seek(size_t offset)
/////////////////////////////////////////////////////////////////////////////
{
 stream.seekg(int64_t(offset));
 stream.seekp(int64_t(offset));

 int result = 0;
 if (!stream.good())
 {
  stream.clear();
  result = 1;
 }

 return result;
}
