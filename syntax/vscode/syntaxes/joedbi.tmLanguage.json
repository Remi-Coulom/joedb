{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "joedbi",
	"patterns": [
		{
			"include": "#comment"
		},
		{
			"include": "#single-command"
		},
		{
			"include": "#command-with-constant-parameter"
		},
		{
			"include": "#update"
		},
		{
			"include": "#operator-vector"
		},
		{
			"include": "#rename-field"
		},
		{
			"include": "#rename-table"
		},
		{
			"include": "#table"
		},
		{
			"include": "#add-field"
		},
		{
			"include": "#drop-field"
		},
		{
			"include": "#record"
		},
		{
			"include": "#insert-into"
		},
		{
			"include": "#delete-from"
		},
		{
			"include": "#custom"
		}
    ],
    "repository": {
        "single-command": 
		{
			"match": "\\b(valid_data|flush|checkpoint|soft_checkpoint|hard_checkpoint|schema|dump|sql|help|about|quit|transaction|push|pull|db)\\b",
			"name": "keyword.control.single.joedbi"
		},
		"command-with-constant-parameter":
		{
			"begin": "\\b(json|echo|write_blob|read_blob|comment|timestamp)\\b",
			"end": "^",
			"name": "keyword.control.constant.parameter.joedbi",
			"patterns": [
				{
					"include": "#joedbi_constant"
				}
			]
		},
		"update":
		{
			"begin": "\\b(update|update_vector)\\b",
			"end": "^",
			"name": "keyword.control.update.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_integer_field_constant"
				}
			]
		},
		"operator-vector":
		{
			"begin": "\\b(insert_vector|delete_vector)\\b",
			"end": "^",
			"name": "keyword.control.vector.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_integer_integer"
				}
			]
		},
		"rename-field":
		{
			"begin": "\\b(rename_field)\\b",
			"end": "^",
			"name": "keyword.control.rename-field.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_field_field"
				}
			]
		},
		"rename-table":
		{
			"begin": "\\b(rename_table)\\b",
			"end": "^",
			"name": "keyword.control.rename-table.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_table"
				}
			]
		},
		"table":
		{
			"begin": "\\b(table|create_table|table_size|drop_table)\\b",
			"end": "^",
			"name": "keyword.control.table.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table"
				}
			]
		},
		"add-field":
		{
			"begin": "\\b(add_field)\\b",
			"end": "^",
			"name": "keyword.control.add-field.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_field_type"
				}
			]
		},
		"drop-field":
		{
			"begin": "\\b(drop_field)\\b",
			"end": "^",
			"name": "keyword.control.drop-field.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_field"
				}
			]
		},
		"record":
		{
			"begin": "\\b(record)\\b",
			"end": "^",
			"name": "keyword.control.record.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_constant"
				}
			]
		},
		"insert-into":
		{
			"begin": "\\b(insert_into)\\b",
			"end": "^",
			"name": "keyword.control.insert-into.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_constant"
				}
			]
		},
		"delete-from":
		{
			"begin": "\\b(delete_from)\\b",
			"end": "^",
			"name": "keyword.control.delete-from.joedbi",
			"patterns": [
				{
					"include": "#joedbi_table_integer"
				}
			]
		},
		"custom":
		{
			"begin": "\\b(custom)\\b",
			"end": "^",
			"name": "keyword.control.custom.joedbi",
			"patterns": [
				{
					"include": "#joedbi_function"
				}
			]
		},

		"joedbi_function":
		{
			"patterns": [
				{
					"include": "#word"
				}
			]
		},
		"joedbi_table":
		{
			"patterns": [
				{
					"include": "#word"
				}
			]
		},
		"joedbi_table_table":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#word"
				}
			]
		},
		"joedbi_table_field":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#word"
				}
			]
		},
		"joedbi_table_constant":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#joedbi_constant"
				}
			]
		},
		"joedbi_table_integer":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#numeric"
				}
			]
		},
		"joedbi_table_field_field":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#word"
				},
				{
					"include": "#word"
				}
			]
		},
		"joedbi_table_integer_integer":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#numeric"
				},
				{
					"include": "#numeric"
				}
			]
		},
		"joedbi_table_integer_field_constant":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#numeric"
				},
				{
					"include": "#word"
				},
				{
					"include": "#joedbi_constant"
				}
			]
		},
		"joedbi_table_field_type":
		{
			"patterns": [
				{
					"include": "#word"
				},
				{
					"include": "#word"
				},
				{
					"include": "#joedbi_type"
				}
			]
		},

		"joedbi_constant":
		{
			"match": ".*",
			"name": "constant.other.joedbi"
		},
		"joedbi_type":
		{
		    "match": "\\b(int8|int16|int32|int64|float32|string|blob|references)\\b",
		    "name": "storage.type.joedbi"
		},
		"word":
		{
			"match": "[a-zA-Z_]\\w*",
			"name": "variable.other.joedbi"
		},
		"numeric":
		{
			"match": "[0-9]+",
			"name": "constant.numeric.joedbi"
		},
		"comment":
		{
			"match": "#.*$",
			"name": "comment.line.joedbi"
		}

    },
	"scopeName": "source.joedbi"
}